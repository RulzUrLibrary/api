{{extends "base.html"}}
{{import "menu.html"}}

{{block header()}} {{yield menu(active="user")}} {{end}}
{{block page_title()}}{{end}}

{{block script()}}
<script src="https://apis.google.com/js/api:client.js"></script>
<script src="/static/js/auth.js"></script>
<script> startApp(); </script>
{{end}}

{{block body()}}
{*
{{define "user"}}
<h1 class="text-center column col-12">Successfully Logged!</h1>
{{end}}
{{define "login"}}
*}
{{next := context.Request().URL.Query().Get("next")}}
<div class="column col-md-12">
  <h2 class="text-center column col-12">Login</h2>
  <form method="POST" id="login">
    <div class="form-group">
      <label class="form-label" for="user">User</label>
      <input class="form-input" name="user" type="text" id="user" placeholder="User" autocomplete="off"/>
    </div>
    <div class="form-group">
      <label class="form-label" for="password">Password</label>
      <input class="form-input"
             name="password"
             type="password"
             id="password"
             placeholder="Password"
             autocomplete="off" />
    </div>
    <input name="X-CSRF-Token" type="hidden" value="{{context.Get("csrf")}}"/>
    <input name="token" type="hidden" id="token"/>
    <input name="next" type="hidden" id="next" value="{{next}}"/>
    {{if error, ok := .["error"]; ok}}
    <div class="text-error mb-2">
      {{capitalize(error.Error())}}
    </div>
    {{end}}
    <div class="form-group columns">
      <div class="column col-3 col-md-12 pt-2">
        <button class="btn btn-primary btn-block" type="submit">
          Submit
        </button>
      </div>
      <div class="column col-3 col-md-12 pt-2">
        <button class="btn btn-default btn-block" type="reset">
          Cancel
        </button>
      </div>
      <div class="column col-6 hide-md col-ml-auto pt-2">
        <button class="btn btn-link btn-block text-right">Forgot your password?</button>
      </div>
      <div class="column col-12 show-md">
        <a href="{{url("reset")}}" class="btn btn-link btn-block">Forgot your password?</a>
      </div>
    </div>
  </form>
  <div class="divider col-12 text-center" data-content="OR"></div>
  <button class="btn btn-block" id="google-signin">
    <img src="/static/img/google_logo.svg" />
    Login with Google
  </button>
</div>
<div class="divider-vert hide-md" data-content="OR"></div>
<div class="divider col-md-12 text-center show-md" data-content="OR"></div>

<div class="column col-md-12">
  <h2 class="text-center column col-12">Signup</h2>
  <form method="GET" action="/auth/new">
    <div class="form-group">
      <label class="form-label" for="create">Email</label>
      <input class="form-input" type="text" id="create" placeholder="Valid email address" name="email">
    </div>
    <div class="form-group">
      <button class="btn btn-primary col-3 col-md-12 mt-10">Sign up</button>
      <button class="btn btn-link col-3 col-md-12 mt-10">Learn more</button>
    </div>
  </form>
</div>
{{end}}


{*
{{define "content"}}
<div class="columns">
  {{if .Context.User}}
  {{template "user" .Context.User}}
  {{else}}
  {{template "login" .}}
  {{end}}
</div>
{{end}}
*}
